SELECT placement.page, placement.top, placement.url, version.title, version.timestamp, version.keywords FROM placement, version, (SELECT url, max(timestamp) as timestamp FROM version GROUP BY url) v, (SELECT url, max(top) as top FROM placement WHERE ended IS NULL GROUP BY url) t WHERE t.top = placement.top AND t.url = placement.url AND v.url = placement.url AND version.timestamp = v.timestamp  GROUP BY placement.page, placement.top, placement.url, version.title, version.timestamp, version.keywords ORDER BY top ASC